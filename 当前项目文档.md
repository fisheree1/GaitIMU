# GaitIMU 当前项目文档

## 1. 项目概览
GaitIMU 是一个基于 Kotlin + Jetpack Compose 的 Android 项目，当前已完成 IMU 采集 MVP 的基础能力：
- 传感器可用性检查（加速度计 + 陀螺仪）
- Start/Stop 采集控制
- 实时数据与采样率显示
- CSV 记录与导出分享

---

## 2. 根目录文件说明

### 2.1 构建与配置
- build.gradle.kts：项目级 Gradle 构建脚本，管理全局插件与构建行为。
- settings.gradle.kts：声明工程名与模块（当前包含 app 模块），并配置依赖仓库策略。
- gradle.properties：Gradle 全局参数（如 JVM 内存、AndroidX 开关等）。
- local.properties：本机环境配置（通常包含 Android SDK 路径，不应提交敏感信息）。
- gradlew / gradlew.bat：Gradle Wrapper 启动脚本（Linux/macOS 与 Windows）。

### 2.2 Gradle Wrapper
- gradle/libs.versions.toml：依赖版本目录，集中管理库与插件版本别名。
- gradle/wrapper/gradle-wrapper.properties：Gradle Wrapper 版本与下载地址配置。
- gradle/wrapper/gradle-wrapper.jar：Wrapper 执行核心二进制。

### 2.3 文档与仓库元数据
- 开发文档.md：项目开发规范、里程碑与算法路线说明。
- .gitignore：Git 忽略规则。

### 2.4 IDE / 缓存目录（通常不手改）
- .git/：Git 仓库元数据。
- .idea/：Android Studio 工程配置。
- .gradle/：Gradle 本地缓存。
- .kotlin/：Kotlin 编译缓存。
- build/：项目级构建输出目录。

---

## 3. app 模块文件说明

### 3.1 模块级构建文件
- app/build.gradle.kts：App 模块构建配置（SDK 版本、依赖、Compose 等）。
- app/proguard-rules.pro：混淆与压缩规则（release 构建使用）。
- app/.gitignore：模块级忽略规则。
- app/build/：模块构建产物目录（自动生成）。

### 3.2 AndroidManifest 与资源
- app/src/main/AndroidManifest.xml：应用清单，声明 Application、MainActivity、FileProvider 等组件。

#### values 资源
- app/src/main/res/values/strings.xml：字符串资源（如应用名）。
- app/src/main/res/values/colors.xml：颜色资源。
- app/src/main/res/values/themes.xml：应用主题定义。

#### drawable 与图标资源
- app/src/main/res/drawable/ic_launcher_background.xml：启动图标背景层。
- app/src/main/res/drawable/ic_launcher_foreground.xml：启动图标前景层。
- app/src/main/res/mipmap-anydpi/ic_launcher.xml：启动图标自适配配置。
- app/src/main/res/mipmap-anydpi/ic_launcher_round.xml：圆形启动图标配置。
- app/src/main/res/mipmap-hdpi、mipmap-mdpi、mipmap-xhdpi、mipmap-xxhdpi、mipmap-xxxhdpi：不同密度下的启动图标资源目录。

#### xml 配置
- app/src/main/res/xml/backup_rules.xml：自动备份规则。
- app/src/main/res/xml/data_extraction_rules.xml：数据提取规则（设备迁移/备份场景）。
- app/src/main/res/xml/file_paths.xml：FileProvider 可共享路径配置（用于 CSV 导出）。

### 3.3 业务代码（main/java）

#### 入口与 UI
- app/src/main/java/com/example/gaitimu/MainActivity.kt：应用入口 Activity，包含 MVP 页面、采集状态管理、Start/Stop、Export/Clear 交互。

#### io 包（文件与导出）
- app/src/main/java/com/example/gaitimu/io/CsvLogger.kt：CSV 文件创建、缓存写入、flush/close 生命周期管理。
- app/src/main/java/com/example/gaitimu/io/FileExporter.kt：通过 FileProvider + 系统分享面板导出 CSV。

#### model 包（数据模型）
- app/src/main/java/com/example/gaitimu/model/ImuSample.kt：统一 IMU 样本数据结构（ts、ax/ay/az、gx/gy/gz）。

#### sensor 包（采集与采样率）
- app/src/main/java/com/example/gaitimu/sensor/ImuRecorder.kt：封装 SensorManager 注册/注销与样本回调输出。
- app/src/main/java/com/example/gaitimu/sensor/SampleRateEstimator.kt：基于时间戳滑动窗口估计采样率。

#### Compose 主题
- app/src/main/java/com/example/gaitimu/ui/theme/Color.kt：主题颜色定义。
- app/src/main/java/com/example/gaitimu/ui/theme/Theme.kt：Compose Material Theme 封装。
- app/src/main/java/com/example/gaitimu/ui/theme/Type.kt：字体排版（Typography）定义。

### 3.4 测试代码
- app/src/androidTest/java/com/example/gaitimu/ExampleInstrumentedTest.kt：设备端仪器化测试示例。
- app/src/test/java/com/example/gaitimu/ExampleUnitTest.kt：本地 JVM 单元测试示例。

---

## 4. 当前实现状态（对应开发文档）
- Milestone 1 已落地核心代码：采集、显示、CSV、导出、前后台停止策略。
- Milestone 2（去重力、滤波、步态指标）尚未实现，建议下一步新增 signal 与 gait 相关类并接入 UI。

---

## 5. 维护建议
- 文档更新原则：每新增一个核心类或配置文件，同步补一行用途说明。
- 目录治理原则：业务逻辑继续按 ui/sensor/signal/gait/io/model 分层，避免 MainActivity 过重。
- 构建治理原则：依赖版本统一在 libs.versions.toml 管理，减少版本漂移。
